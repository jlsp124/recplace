<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin — Recplace Professional Centre</title>
    <meta name="description" content="Moderator-only page for adding updates (downloads updated JSON)." />
    <link rel="stylesheet" href="css/site.css" />
  </head>
  <body>
    <header id="site-header"></header>

    <main>
      <section class="section">
        <div class="container">
          <div class="card" data-gate="admin">
            <div class="card-body">
              <h1 class="section-title" style="margin: 0 0 10px">Admin</h1>
              <p class="section-subtitle" style="margin: 0 0 14px">
                Moderator-only access to add updates. (Static deterrent only.)
              </p>
              <form class="form">
                <div>
                  <label for="admin-password">Password</label>
                  <input id="admin-password" type="password" autocomplete="current-password" required />
                </div>
                <button class="btn btn--primary btn-block" type="submit">Continue</button>
                <div class="form-help">
                  For real protection, host with server auth / Cloudflare Access. Static sites can be bypassed via
                  view-source.
                </div>
                <div class="error" data-gate-error hidden></div>
              </form>
            </div>
          </div>

          <div data-gated="admin" hidden>
            <div class="card">
              <div class="card-body">
                <div style="display: flex; justify-content: space-between; gap: 12px; flex-wrap: wrap">
                  <div>
                    <h1 class="section-title" style="margin: 0 0 8px">Update Moderator</h1>
                    <p class="section-subtitle" style="margin: 0">
                      Adds a post and lets you download an updated <span class="mono">data/updates.json</span>.
                    </p>
                  </div>
                  <button class="btn btn--danger" type="button" data-gate-lock>Lock</button>
                </div>
              </div>
            </div>

            <div class="divider"></div>

            <div class="two-col">
              <div>
                <div class="card">
                  <div class="card-body">
                    <h2 class="section-title" style="margin: 0 0 10px">Add update</h2>
                    <form id="admin-form" class="form">
                      <div>
                        <label for="u-title">Title</label>
                        <input id="u-title" required />
                      </div>
                      <div>
                        <label for="u-date">Date</label>
                        <input id="u-date" type="date" required />
                      </div>
                      <div>
                        <label for="u-category">Category</label>
                        <select id="u-category">
                          <option>Construction</option>
                          <option>Leasing</option>
                          <option>Notices</option>
                          <option>Media</option>
                        </select>
                      </div>
                      <div>
                        <label for="u-body">Body</label>
                        <textarea id="u-body" required></textarea>
                      </div>
                      <div>
                        <label for="u-image">Optional image path</label>
                        <input id="u-image" placeholder="Assets/updates/your-image.jpg" />
                        <div class="form-help">
                          If you add an image, place it in <span class="mono">Assets/updates/</span> and use the matching
                          path.
                        </div>
                        <div style="height: 10px"></div>
                        <label for="u-image-file">Or pick an image (fills the path)</label>
                        <input id="u-image-file" type="file" accept="image/*" />
                        <div style="height: 10px"></div>
                        <img
                          id="u-image-preview"
                          alt=""
                          hidden
                          style="border-radius: 14px; border: 1px solid rgba(255, 255, 255, 0.14)"
                        />
                      </div>
                      <div class="error" id="admin-error" hidden></div>
                      <button class="btn btn--primary btn-block" type="submit">Generate updated JSON</button>
                    </form>
                  </div>
                </div>
              </div>

              <div class="sticky-card">
                <div class="card">
                  <div class="card-body">
                    <h2 class="section-title" style="margin: 0 0 10px">Output</h2>
                    <p class="section-subtitle" style="margin: 0 0 12px">
                      Download the file, then replace <span class="mono">data/updates.json</span> with it.
                    </p>
                    <button class="btn btn--primary btn-block" id="admin-download" type="button" disabled>
                      Download updates.json
                    </button>
                    <div class="divider" style="margin: 14px 0"></div>
                    <pre
                      class="mono"
                      id="admin-preview"
                      style="
                        white-space: pre-wrap;
                        margin: 0;
                        color: rgba(255, 255, 255, 0.8);
                        font-size: 12px;
                        max-height: 420px;
                        overflow: auto;
                      "
                    ></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <script id="updates-data" type="application/json">
            [
              {
                "id": "purpose",
                "date": "2025-12-13",
                "category": "Notices",
                "title": "What this page is for",
                "body": "Construction notices, tenant announcements, closures/renos that affect the building — all in one place."
              },
              {
                "id": "construction-soon",
                "date": "2025-12-13",
                "category": "Construction",
                "title": "Construction starting soon",
                "body": "The current leasing info notes breaking ground this spring. Timelines can shift — confirm with leasing for the latest."
              },
              {
                "id": "coordination-set",
                "date": "2025-12-04",
                "category": "Media",
                "title": "Design Coordination Set Issued — Dec 4, 2025",
                "body": "A coordination drawing set was issued on 2025-12-04."
              }
            ]
          </script>
        </div>
      </section>
    </main>

    <footer id="site-footer"></footer>
    <div id="site-cta"></div>

    <script src="js/site.js" defer></script>
    <script src="js/admin.js" defer></script>
  </body>
</html>

